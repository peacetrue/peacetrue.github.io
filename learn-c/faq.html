<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常见问题 :: 安宁的知识库</title>
    <link rel="canonical" href="https://peacetrue.github.io/learn-c/faq.html">
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
    <script>var uiRootPath = '../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://peacetrue.github.io">安宁的知识库</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="learn-c" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">学习 C 语言</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">概述</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="start.html">快速入门</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="builder.html">项目构建</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ide.html">集成开发环境</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="test.html">测试框架</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">相关主题</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="topic/elf.html">ELF</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="topic/gas.html">AT&amp;T 汇编语法</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="topic/graffle.html">Graffle 导出图</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="glossary.html">术语</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="faq.html">常见问题</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="version.html">版本变更</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">学习 C 语言</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../peacetrue-shell/index.html">Shell 脚本库</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../peacetrue-shell/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../peacetrue-common/index.html">公共组件</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../peacetrue-common/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../peacetrue-result/index.html">响应结果组件</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../peacetrue-result/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../learn-asciidoc/index.html">学习 AsciiDoc</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../learn-asciidoc/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">学习 C 语言</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../peacetrue-cryptography/index.html">密码学组件</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../peacetrue-cryptography/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../bee/index.html">开发者助手</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../bee/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../overview/index.html">总览</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../overview/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../peacetrue-test/index.html">测试组件</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../peacetrue-test/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../peacetrue-beans/index.html">简单 Java 对象</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../peacetrue-beans/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../overview/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">学习 C 语言</a></li>
    <li><a href="faq.html">常见问题</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/peacetrue/learn-c/edit/master/docs/antora/modules/ROOT/pages/faq.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">常见问题</h1>
<div class="sect1">
<h2 id="_macos_无法正常使用_gdb"><a class="anchor" href="#_macos_无法正常使用_gdb"></a>1. macOS 无法正常使用 GDB</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">uname -a
# Darwin Kernel Version 22.4.0: Mon Mar  6 21:00:17 PST 2023; root:xnu-8796.101.5~3/RELEASE_X86_64 x86_64
# macOS 13.3

brew uninstall --force gdb
brew install gdb
gdb -v
# GNU gdb (GDB) 13.1

gcc -g main.cpp -o main
./main
gdb main
# Reading symbols from main...
(gdb) b main
# Breakpoint 1 at 0x100003f84: file main.cpp, line 4.
(gdb) i b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x0000000100003f84 in main() at main.cpp:4
(gdb) r
#Starting program: /Users/xiayx/Documents/Projects/learn-c/src/instruction/cpp/main
#Unable to find Mach task port for process-id 25679: (os/kern) failure (0x5).
# (please check gdb is codesigned - see taskgated(8))
(gdb) q</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_please_check_gdb_is_codesigned"><a class="anchor" href="#_please_check_gdb_is_codesigned"></a>1.1. please check gdb is codesigned</h3>
<div class="paragraph">
<p>发生此错误是因为 OSX 实现了 pid 访问策略，该策略需要二进制文件的数字签名才能访问其他进程的 pid。
要使 gdb 能够访问其他进程，我们必须首先对二进制文件进行代码签名。此签名取决于特定的证书，用户必须创建该证书并在系统中注册。</p>
</div>
<div class="paragraph">
<p>要创建代码签名证书，请打开钥匙串访问应用程序。选择菜单 Keychain Access &#8594; Certificate Assistant &#8594; Create a Certificate …</p>
</div>
<div class="paragraph">
<p>为证书选择一个名称（例如 gdb-cert），将身份类型设置为自签名根，将证书类型设置为代码签名并选择让我覆盖默认值。在 Continue 上多次单击，直到您到达 Specify a Location For The Certificate 屏幕，然后将 Keychain 设置为 System。</p>
</div>
<div class="paragraph">
<p>双击证书，打开信任部分，并将代码签名设置为始终信任。退出钥匙串访问应用程序。</p>
</div>
<div class="paragraph">
<p>重新启动任务化服务，并对二进制文件进行签名。</p>
</div>
</div>
<div class="sect2">
<h3 id="_配置证书"><a class="anchor" href="#_配置证书"></a>1.2. 配置证书</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-log_mini hljs" data-lang="log_mini">Name : gdb-cert
Identity Type: Self Signed Root
Certificate Type : Code Signing</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_签名_gdb"><a class="anchor" href="#_签名_gdb"></a>1.3. 签名 GDB</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash"># 重启任务化服务，以识别证书
sudo killall taskgated
# 签名
codesign --entitlements gdb-entitlement.xml -fs gdb-cert $(which gdb)
#codesign -fs gdb-cert "/usr/local/Cellar/gdb/13.1/bin/gdb"
# 验证
codesign -v $(which gdb)
# 再次运行
gdb main</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_warning_unhandled_dyld_version_17"><a class="anchor" href="#_warning_unhandled_dyld_version_17"></a>1.4. warning: unhandled dyld version (17)</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">ld -v
#BUILD 16:59:53 Feb 24 2023
#configured to support archs: armv6 armv7 armv7s arm64 arm64e arm64_32 i386 x86_64 x86_64h armv6m armv7k armv7m armv7em
#LTO support using: LLVM version 14.0.3, (clang-1403.0.22.14.1) (static support for 29, runtime is 29)
#TAPI support using: Apple TAPI version 14.0.3 (tapi-1403.0.5.1)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_参考"><a class="anchor" href="#_参考"></a>1.5. 参考</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://stackoverflow.com/questions/18423124/please-check-gdb-is-codesigned-see-taskgated8-how-to-get-gdb-installed-w" target="_blank" rel="noopener">How to get gdb installed with homebrew code signed?</a></p>
</li>
<li>
<p><a href="https://sourceware.org/gdb/wiki/PermissionsDarwin" target="_blank" rel="noopener">PermissionsDarwin</a></p>
</li>
<li>
<p><a href="https://github.com/Homebrew/homebrew-core/issues/20047" target="_blank" rel="noopener">warning: unhandled dyld version (17)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
